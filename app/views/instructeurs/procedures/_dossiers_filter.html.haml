%span.dropdown
  %button.button.dropdown-button{ 'aria-expanded' => 'false', 'aria-controls' => 'filter-menu' }
    Filtrer
  #filter-menu.dropdown-content.left-aligned.fade-in-down
    = form_tag add_filter_instructeur_procedure_path(procedure), method: :post, class: 'dropdown-form large' do
      = label_tag :field,  "Colonne"
      = select_tag :field, options_for_select(displayed_fields_options)
      %br
      = label_tag :value, "Valeur"
      = text_field_tag :value, nil, maxlength: ProcedurePresentation::FILTERS_VALUE_MAX_LENGTH
      = hidden_field_tag :statut, statut
      %br
      = submit_tag "Ajouter le filtre", class: 'button'

- current_filters.group_by { |filter| filter['table'] }.each_with_index do |(table, filters), i|
  - if i > 0
    et
  - filters.each_with_index do |filter, i|
    - if i > 0
      ou
    %span.filter
      = link_to remove_filter_instructeur_procedure_path(procedure, { statut: statut, field: "#{filter['table']}/#{filter['column']}", value: filter['value'] }) do
        %img.close-icon{ src: image_url("close.svg") }
      = "#{filter['label'].truncate(50)} : #{procedure_presentation.human_value_for_filter(filter)}"
