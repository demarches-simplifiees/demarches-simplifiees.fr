- content_for(:title, 'Contact')
- content_for :footer do
  = render partial: "root/footer"

#contact-form
  .container
    %h1.new-h1 Contact

    = form_tag contact_path, method: :post, multipart: true, class: 'form' do |f|

      .description
        %p
          Contactez-nous via ce formulaire et nous vous rÃ©pondrons dans les plus brefs dÃ©lais.
          Pensez bien Ã  nous donner le plus d'informations possible pour que nous puissions vous aider au mieux.
        %br
        %p.mandatory-explanation
          Les champs suivis dâ€™un astÃ©risque (
          %span.mandatory *
          ) sont obligatoires.

      - if !user_signed_in?
        .contact-champ
          = label_tag :email do
            Email
            %span.mandatory *
          = text_field_tag :email, params[:email], required: true

      .contact-champ
        = label_tag :type do
          Votre question
          %span.mandatory *
        = select_tag :type, options_for_select(@options, params[:type]), include_blank: "Choisir une question", required: true

      .support.card.featured.hidden{ data: { 'contact-type-only': Helpscout::FormAdapter::TYPE_INFO } }
        .card-title
          ðŸ‘‰ Notre rÃ©ponse
        .card-content
          %p
            Avez-vous bien vÃ©rifiÃ© que tous les champs obligatoires (
            %span.mandatory *
            ) sont bien remplis ?
          %p Si vous avez des questions sur les informations Ã  saisir, contactez les services en charge de la dÃ©marche.
          %p
            %a{ href: 'https://faq.demarches-simplifiees.fr/article/12-contacter-le-service-en-charge-de-ma-demarche' }
              En savoir plus

      .support.card.featured.hidden{ data: { 'contact-type-only': Helpscout::FormAdapter::TYPE_PERDU } }
        .card-title
          ðŸ‘‰ Notre rÃ©ponse
        .card-content
          %p Nous vous invitons Ã  contacter lâ€™administration en charge de votre dÃ©marche pour quâ€™elle vous indique le lien Ã  suivre. Celui-ci devrait ressembler Ã  cela : https://www.demarches-simplifiees.fr/commencer/NOM_DE_LA_DEMARCHE .
          %br
          %p Vous pouvez aussi consulter ici la liste de nos dÃ©marches les plus frequentes (permis, detr etc) :
          %p
            %a{ href: 'https://doc.demarches-simplifiees.fr/listes-des-demarches' }
              https://doc.demarches-simplifiees.fr/listes-des-demarches

      .support.card.featured.hidden{ data: { 'contact-type-only': Helpscout::FormAdapter::TYPE_INSTRUCTION } }
        .card-title
          ðŸ‘‰ Notre rÃ©ponse
        %p Si vous avez des questions sur lâ€™instruction de votre dossier (par exemple sur les dÃ©lais), nous vous invitons Ã  contacter directement les services qui instruisent votre dossier par votre messagerie.
        %p
          %a{ href: 'https://faq.demarches-simplifiees.fr/article/11-je-veux-savoir-ou-en-est-linstruction-de-ma-demarche' }
            En savoir plus
        %br
        %p Si vous souhaitez poser une question pour un problÃ¨me technique sur le site, utilisez le formulaire ci-dessous. Nous ne pourrons pas vous renseigner sur l'instruction de votre dossier.

      .support.card.featured.hidden{ data: { 'contact-type-only': Helpscout::FormAdapter::TYPE_AMELIORATION } }
        .card-title
          ðŸ‘‰ Notre rÃ©ponse
        %p
          Une idÃ©eÂ ? Pensez Ã  consulter notre
          = succeed 'Â !' do
            %strong
              tableau de bord des amÃ©liorations
        %p
          %ul
            %li â€¢Â Votez pour vos amÃ©liorations prioritairesÂ ;
            %li â€¢Â Proposez votre propre idÃ©e.

        %p
          %strong
            %a{ href: 'https://demarches-simplifiees.featureupvote.com' }
              âž¡ AccÃ©der au tableau des amÃ©liorations

      .contact-champ
        = label_tag :dossier_id, 'NumÃ©ro du dossier concernÃ©'
        = text_field_tag :dossier_id, @dossier_id

      .contact-champ
        = label_tag :subject do
          Sujet
          %span.mandatory *
        = text_field_tag :subject, params[:subject], required: true

      .contact-champ
        = label_tag :text do
          Message
          %span.mandatory *
        = text_area_tag :text, params[:text], rows: 6, required: true

      .contact-champ
        = label_tag :piece_jointe do
          PiÃ¨ce jointe
        %p.notice.hidden{ data: { 'contact-type-only': Helpscout::FormAdapter::TYPE_AMELIORATION } }
          Une capture dâ€™Ã©cran peut nous aider Ã  identifier plus facilement lâ€™endroit Ã  amÃ©liorer.
        %p.notice.hidden{ data: { 'contact-type-only': Helpscout::FormAdapter::TYPE_AUTRE } }
          Une capture dâ€™Ã©cran peut nous aider Ã  identifier plus facilement le problÃ¨me.
        = file_field_tag :piece_jointe

      = hidden_field_tag :tags, @tags&.join(',')

      .send-wrapper
        = button_tag 'Envoyer le message', type: :submit, class: 'button send primary'
