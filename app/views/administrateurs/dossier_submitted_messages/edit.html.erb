<% content_for(:root_class, 'scroll-margins-for-sticky-footer') %>

<%= render partial: 'administrateurs/breadcrumbs',
  locals: { steps: [['Démarches', admin_procedures_path],
                    [@procedure.libelle.truncate_words(10), admin_procedure_path(@procedure)],
                    ['Fin de dépôt']] } %>

<%= form_for @dossier_submitted_message,
  url: url_for({ controller: 'administrateurs/dossier_submitted_messages', action: :update, id: @procedure.id }) do |f| %>

  <div class="tiptap-content-editor fr-container fr-my-4w" data-controller="tiptap">
    <div class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-lg-7">
        <fieldset class="fr-fieldset" aria-labelledby="edit-dossier-submitted-message">
          <legend class="fr-fieldset__legend" id="edit-dossier-submitted-message">
            <h1 class="fr-h2">Fin de dépôt</h1>
            <p class="fr-text--regular">
              Personnalisez le message affiché à l’usager après le dépôt de son dossier.
            </p>
          </legend>

          <div class="fr-fieldset__element">
            <%= render TiptapEditorComponent.new(form: f, field_name: :tiptap_body) %>
          </div>
        </fieldset>
      </div>

      <div class="fr-col-12 fr-col-lg-5 fr-background-alt--blue-france fr-py-3w">
        <h2 class="fr-h4">Aperçu</h2>
        <div class="realistic-preview">
          <%= render partial: 'users/dossiers/merci', locals: { procedure: @procedure, dossier: nil } %>
        </div>
        <p class="fr-hint-text">
          L’aperçu est mis à jour après chaque enregistrement.
        </p>
      </div>
    </div>
  </div>

  <%= render Procedure::FixedFooterComponent.new(procedure: @procedure, form: f) %>
<% end %>
